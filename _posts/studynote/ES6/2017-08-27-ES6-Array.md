---
layout: post
title: "ES6 - æ•°ç»„çš„æ‰©å±•"
data: 2017-08-27 10:27:00 +0800
categories: å­¦ä¹ ç¬”è®°
tag: ES6
---
* content
{:toc}

å…¶ä»–é“¾æ¥ï¼š

+ [javascript - æ•°ç»„]({{ '/2017/08/27/js-Array' | prepend: site.baseurl }})

> ä»¥ä¸‹å†…å®¹å…¨éƒ¨æºäºï¼š [http://es6.ruanyifeng.com/#docs/array](http://es6.ruanyifeng.com/#docs/array)

<!-- more -->

## 1ã€æ‰©å±•è¿ç®—ç¬¦ (`spread`)

### 1.1 å«ä¹‰

> * æ‰©å±•è¿ç®—ç¬¦æ˜¯ä¸‰ä¸ªç‚¹ï¼ˆ...ï¼‰ã€‚å®ƒå¥½æ¯” `rest` å‚æ•°çš„é€†è¿ç®—ï¼Œå°†ä¸€ä¸ªæ•°ç»„è½¬ä¸ºç”¨é€—å·åˆ†éš”çš„å‚æ•°åºåˆ—ã€‚


```js
console.log(1, ...[2, 3, 4], 5)  // 1 2 3 4 5
````

> * è¯¥è¿ç®—ç¬¦ä¸»è¦ç”¨äºå‡½æ•°è°ƒç”¨ã€‚

```js
function f(v, w, x, y, z) { }
var args = [0, 1];
f(-1, ...args, 2, ...[3]);
```

> * æ‰©å±•è¿ç®—ç¬¦åé¢è¿˜å¯ä»¥æ”¾ç½®è¡¨è¾¾å¼ã€‚

```js
const arr = [
  ...(x > 0 ? ['a'] : []),
  'b',
];
```

> * å¦‚æœæ‰©å±•è¿ç®—ç¬¦åé¢æ˜¯ä¸€ä¸ªç©ºæ•°ç»„ï¼Œåˆ™ä¸äº§ç”Ÿä»»ä½•æ•ˆæœã€‚

```js
[...[], 1]  // [1]
```

### 1.2ã€æ›¿ä»£æ•°ç»„çš„ apply æ–¹æ³• 

> * ç”±äºæ‰©å±•è¿ç®—ç¬¦å¯ä»¥å±•å¼€æ•°ç»„ï¼Œæ‰€ä»¥ä¸å†éœ€è¦applyæ–¹æ³•ï¼Œå°†æ•°ç»„è½¬ä¸ºå‡½æ•°çš„å‚æ•°äº†ã€‚

```js
function f(x, y, z) {
  // ...
}
var args = [0, 1, 2];

// ES5 çš„å†™æ³•
f.apply(null, args);

// ES6çš„å†™æ³•
f(...args);
 ```

> * ä¸‹é¢æ˜¯æ‰©å±•è¿ç®—ç¬¦å–ä»£applyæ–¹æ³•çš„ä¸€ä¸ªå®é™…çš„ä¾‹å­ï¼Œåº”ç”¨`Math.max`æ–¹æ³•ï¼Œç®€åŒ–æ±‚å‡ºä¸€ä¸ªæ•°ç»„æœ€å¤§å…ƒç´ çš„å†™æ³•ã€‚

```js
// ES5 çš„å†™æ³•
Math.max.apply(null, [14, 3, 77])

// ES6 çš„å†™æ³•
Math.max(...[14, 3, 77])

// ç­‰åŒäº
Math.max(14, 3, 77);
```

### 1.3 æ‰©å±•è¿ç®—ç¬¦çš„åº”ç”¨

> * åˆå¹¶æ•°ç»„ã€ç‚¹å‡»æ‰“å¼€[demo](/effects/demo/es6/array/eg1.html)ã€‘

```js
    let arr1 = ['a', 'b'];
    let arr2 = [1, 2];
    let arr3 = [5, 'c'];

    // es5
    console.log(arr1.concat(arr2, arr3) ) // ["a", "b", 1, 2, 5, "c"]

    // es6
    console.log([...arr1, ...arr2, ...arr3]) // ["a", "b", 1, 2, 5, "c"]
```

---

> * ä¸è§£æ„èµ‹å€¼ç»“åˆã€ç‚¹å‡»æ‰“å¼€[demo](/effects/demo/es6/array/eg2.html)ã€‘
> * `Rest element must be last element` ===ã€‹ æ‰©å±•è¿ç®—ç¬¦åªèƒ½æ”¾åœ¨å‚æ•°çš„æœ€åä¸€ä½

```js
    const [first, ...rest1] = [1, 2, 3, 4, 5];
    console.log(first, rest1); // 1 [2, 3, 4, 5]

    const [second, ...rest2] = [];
    console.log(second, rest2); // undefined []

    const [third, ...rest3] = ['foo'];
    console.log(third, rest3); // foo []

    // æŠ¥é”™ï¼š Rest element must be last element
    // const [...rest4, last] = [1, 2, 3, 4, 5];
```

---

> * å­—ç¬¦ä¸² ã€ç‚¹å‡»æ‰“å¼€[demo](/effects/demo/es6/array/eg3.html)ã€‘
>   * æ‰©å±•è¿ç®—ç¬¦è¿˜å¯ä»¥å°†å­—ç¬¦ä¸²è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚
>   * è¿˜èƒ½å¤Ÿæ­£ç¡®è¯†åˆ«32ä½çš„ `Unicode` å­—ç¬¦ã€‚
>       * `JavaScript` ä¼šå°†32ä½ `Unicode` å­—ç¬¦ï¼Œè¯†åˆ«ä¸º2ä¸ªå­—ç¬¦ï¼Œé‡‡ç”¨æ‰©å±•è¿ç®—ç¬¦å°±æ²¡æœ‰è¿™ä¸ªé—®é¢˜ã€‚
    
```js
    // ä¾‹1
    console.log([...'hello']); // ["h", "e", "l", "l", "o"]

    // ä¾‹2
    function getLength (str) {
      return [...str].length;
    }

    let str = 'x\uD83D\uDE80y'
    console.log(getLength(str)) // 3
    console.log(str.length); // 4

    // å¦‚æœä¸ç”¨æ‰©å±•è¿ç®—ç¬¦ï¼Œå­—ç¬¦ä¸²çš„reverseæ“ä½œå°±ä¸æ­£ç¡®ã€‚
    console.log(str.split('').reverse().join()) // y,ï¿½,ï¿½,x
    console.log([...str].reverse().join()); // y,ğŸš€,x
````

---

> * å®ç°äº† `Iterator` æ¥å£çš„å¯¹è±¡ ã€ç‚¹å‡»æ‰“å¼€[demo](/effects/demo/es6/array/eg4.html)ã€‘
>    * ä»»ä½• `Iterator` æ¥å£çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥ç”¨æ‰©å±•è¿ç®—ç¬¦è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚
>    * `querySelectorAll`æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ª`nodeList`å¯¹è±¡ã€‚å®ƒä¸æ˜¯æ•°ç»„ï¼Œè€Œæ˜¯ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ã€‚è¿™æ—¶ï¼Œæ‰©å±•è¿ç®—ç¬¦å¯ä»¥å°†å…¶è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ï¼Œ**åŸå› å°±åœ¨äº`NodeList`å¯¹è±¡å®ç°äº† `Iterator`**ã€‚
>    * å¯¹äºé‚£äº›æ²¡æœ‰éƒ¨ç½² `Iterator` æ¥å£çš„ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œæ‰©å±•è¿ç®—ç¬¦å°±æ— æ³•å°†å…¶è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚

```js
    // ä¾‹1ï¼šå°†ç±»æ•°ç»„è½¬åŒ–ä¸ºçœŸæ­£çš„æ•°ç»„
    let nodeLsit = document.querySelectorAll('div');
    console.log(nodeLsit); // è¿˜æ˜¯ NodeList
    console.log([...nodeLsit]); // å˜æˆ Array

    // ä¾‹2ï¼šæ²¡æœ‰éƒ¨ç½² Iterator æ¥å£ï¼Œæ‰©å±•è¿ç®—ç¬¦æŠ¥é”™
    // ä½¿ç”¨`Array.from`æ–¹æ³•å°†`arrayLike`è½¬ä¸ºçœŸæ­£çš„æ•°ç»„
    let arrayLike = {
      '0': 'a',
      '1': 'b',
      '2': 'c',
      length: 3
    };
    // æŠ¥é”™ï¼šTypeError: arrayLike is not iterable
    // console.log([...arrayLike])
    console.log(Array.from(arrayLike)); // ["a", "b", "c"]
````

---

> * `Map` å’Œ `Set` ç»“æ„ï¼Œ`Generator` å‡½æ•° ã€ç‚¹å‡»æ‰“å¼€[demo](/effects/demo/es6/array/eg5.html)ã€‘
>    * æ‰©å±•è¿ç®—ç¬¦å†…éƒ¨è°ƒç”¨çš„æ˜¯æ•°æ®ç»“æ„çš„ `Iterator` æ¥å£ï¼Œå› æ­¤åªè¦å…·æœ‰ `Iterator` æ¥å£çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ï¼Œæ¯”å¦‚ `Map` ç»“æ„ã€‚
>    * `Generator` å‡½æ•°è¿è¡Œåï¼Œè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œå› æ­¤ä¹Ÿå¯ä»¥ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ã€‚

```js
    // ä¾‹1ï¼šMap
    let map = new Map(
      [
        [1, 'one'],
        [2, 'two'],
        [3, 'three'],
      ]
    )
    console.log([...map.keys()]) // [1, 2, 3]

    // ä¾‹2 Generator - æ‰§è¡Œåè¿”å›çš„æ˜¯ä¸€ä¸ªéå†å™¨å¯¹è±¡
    // å¯¹è¿™ä¸ªéå†å™¨å¯¹è±¡æ‰§è¡Œæ‰©å±•è¿ç®—ç¬¦ï¼Œå°±ä¼šå°†å†…éƒ¨éå†å¾—åˆ°çš„å€¼ï¼Œè½¬ä¸ºä¸€ä¸ªæ•°ç»„
    let go = function* () {
      yield 1;
      yield 2;
      yield 3;
    }
    console.log(...go()); // 1 2 3
````

## 2ã€Array.from()

### 2.1 Array.from()çš„åŸºæœ¬ç”¨æ³•ï¼ˆåªä¼ ä¸€ä¸ªå‚æ•°ï¼‰

> * `Array.from`æ–¹æ³•ç”¨äºå°†ä¸¤ç±»å¯¹è±¡è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ï¼šç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼ˆ`array-like object`ï¼‰å’Œå¯éå†ï¼ˆ`iterable`ï¼‰çš„å¯¹è±¡ï¼ˆåŒ…æ‹¬`ES6`æ–°å¢çš„æ•°æ®ç»“æ„`Set`å’Œ`Map`ï¼‰ã€‚
> * å®é™…åº”ç”¨ä¸­ï¼Œå¸¸è§çš„ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡æ˜¯`DOM` æ“ä½œè¿”å›çš„ `NodeList` é›†åˆï¼Œä»¥åŠå‡½æ•°å†…éƒ¨çš„`arguments`å¯¹è±¡ï¼ŒArray.froméƒ½å¯ä»¥å°†å®ƒä»¬è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚
> * ã€ç‚¹å‡»æ‰“å¼€[demo](/effects/demo/es6/array/eg6.html)ã€‘

```js
    // ä¾‹1ï¼š
    let arrayLike = {
      '0': 'a',
      '1': 'b',
      '2': 'c',
      length: 3
    };
    // es5
    console.log([].slice.call(arrayLike)) // ["a", "b", "c"]
    // es6
    console.log(Array.from(arrayLike)) // ["a", "b", "c"]

    // å¦‚æœå‚æ•°æ˜¯ä¸€ä¸ªçœŸæ­£çš„æ•°ç»„ï¼ŒArray.fromä¼šè¿”å›ä¸€ä¸ªä¸€æ¨¡ä¸€æ ·çš„æ–°æ•°ç»„
    console.log(Array.from([1, 2, 3])); // [1, 2, 3]
```

> * æ‰©å±•è¿ç®—ç¬¦ï¼ˆ...ï¼‰ä¹Ÿå¯ä»¥å°†æŸäº›æ•°æ®ç»“æ„è½¬ä¸ºæ•°ç»„ã€‚
>    * æ‰©å±•è¿ç®—ç¬¦èƒŒåè°ƒç”¨çš„æ˜¯éå†å™¨æ¥å£ï¼ˆ`Symbol.iterator`ï¼‰ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡æ²¡æœ‰éƒ¨ç½²è¿™ä¸ªæ¥å£ï¼Œå°±æ— æ³•è½¬æ¢ã€‚
>    * `Array.from` æ–¹æ³•è¿˜æ”¯æŒç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ã€‚æ‰€è°“ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œ`æœ¬è´¨ç‰¹å¾åªæœ‰ä¸€ç‚¹ï¼Œå³å¿…é¡»æœ‰lengthå±æ€§`ã€‚
>    * å› æ­¤ï¼Œä»»ä½•æœ‰ `length` å±æ€§çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥é€šè¿‡ `Array.from` æ–¹æ³•è½¬ä¸ºæ•°ç»„ï¼Œè€Œæ­¤æ—¶æ‰©å±•è¿ç®—ç¬¦å°±æ— æ³•è½¬æ¢ã€‚

```js
// argumentså¯¹è±¡
function foo() {
  var args = [...arguments];
}

// NodeListå¯¹è±¡
[...document.querySelectorAll('div')]

// æœ‰æœ¬è´¨ç‰¹å¾çš„ç±»æ•°ç»„
Array.from({ length: 3 });// [ undefined, undefined, undefined ]
```

### 2.2 Array.from()çš„è¿›é˜¶ï¼ˆä¼ ç¬¬äºŒä¸ªå‚æ•°ï¼‰

> * ç¬¬äºŒä¸ªå‚æ•°ï¼Œä½œç”¨ç±»ä¼¼äºæ•°ç»„çš„mapæ–¹æ³•ï¼Œç”¨æ¥å¯¹æ¯ä¸ªå…ƒç´ è¿›è¡Œå¤„ç†ï¼Œå°†å¤„ç†åçš„å€¼æ”¾å…¥è¿”å›çš„æ•°ç»„ã€‚
> * ã€ç‚¹å‡»æ‰“å¼€[demo](/effects/demo/es6/array/eg7.html)ã€‘

```js
    // ä¾‹1ï¼š
    Array.from([1, 2, 3], (item) => {
      console.log(item);
      // 1
      // 2
      // 3
    })

    // ä¾‹2ï¼šå°†æ•°ç»„ä¸­å¸ƒå°”å€¼ä¸ºfalseçš„æˆå‘˜è½¬ä¸º0ã€‚
    console.log(Array.from([1, , 2, , 3], (n) => n || 0))  // [1, 0, 2, 0, 3]

    // ä¾‹3ï¼šè¿”å›å„ç§æ•°æ®çš„ç±»å‹ã€‚
    function typesOf () {
      return Array.from(arguments, value => typeof value)
    }
    console.log( typesOf(null, [], NaN)) // ['object', 'object', 'number']

    // ä¾‹4ï¼šArray.fromçš„ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šäº†ç¬¬äºŒä¸ªå‚æ•°è¿è¡Œçš„æ¬¡æ•°ã€‚
    console.log(Array.from({ length: 2 }, () => 'jack')) // ['jack', 'jack']
```

### 2.2 Array.from()çš„è¿›é˜¶ï¼ˆä¼ ç¬¬ä¸‰ä¸ªå‚æ•°ï¼‰

> * å¦‚æœmapå‡½æ•°é‡Œé¢ç”¨åˆ°äº†`this`å…³é”®å­—ï¼Œè¿˜å¯ä»¥ä¼ å…¥ `Array.from` çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œç”¨æ¥ç»‘å®š `this` ã€‚

> * `Array.from()` å¯ä»¥å°†å„ç§å€¼è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ï¼Œå¹¶ä¸”è¿˜æä¾›`map`åŠŸèƒ½ã€‚è¿™å®é™…ä¸Šæ„å‘³ç€ï¼Œ**åªè¦æœ‰ä¸€ä¸ªåŸå§‹çš„æ•°æ®ç»“æ„ï¼Œä½ å°±å¯ä»¥å…ˆå¯¹å®ƒçš„å€¼è¿›è¡Œå¤„ç†ï¼Œç„¶åè½¬æˆè§„èŒƒçš„æ•°ç»„ç»“æ„ï¼Œè¿›è€Œå°±å¯ä»¥ä½¿ç”¨æ•°é‡ä¼—å¤šçš„æ•°ç»„æ–¹æ³•**ã€‚

### 2.3 Array.from()åº”ç”¨

> * å°†å­—ç¬¦ä¸²è½¬ä¸ºæ•°ç»„ï¼Œç„¶åè¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚å› ä¸ºå®ƒèƒ½æ­£ç¡®å¤„ç†å„ç§ `Unicode` å­—ç¬¦ï¼Œå¯ä»¥é¿å… `JavaScript` å°†å¤§äº `\uFFFF` çš„ `Unicode` å­—ç¬¦ï¼Œç®—ä½œä¸¤ä¸ªå­—ç¬¦çš„ `bug`ã€‚
```js
function countSymbols(string) {
  return Array.from(string).length;
}
````

## 3ã€Array.of()

> * `Array()`ï¼šåªæœ‰å½“å‚æ•°ä¸ªæ•°ä¸å°‘äº`2`ä¸ªæ—¶ï¼Œ`Array()`æ‰ä¼šè¿”å›ç”±å‚æ•°ç»„æˆçš„æ–°æ•°ç»„ã€‚å‚æ•°ä¸ªæ•°åªæœ‰ä¸€ä¸ªæ—¶ï¼Œå®é™…ä¸Šæ˜¯æŒ‡å®šæ•°ç»„çš„é•¿åº¦ã€‚

> * `Array.of`æ–¹æ³•ç”¨äºå°†ä¸€ç»„å€¼ï¼Œè½¬æ¢ä¸ºæ•°ç»„ã€‚
>    * ä¸»è¦ç›®çš„ï¼šå¼¥è¡¥æ•°ç»„æ„é€ å‡½æ•°`Array()`çš„ä¸è¶³ã€‚å› ä¸ºå‚æ•°ä¸ªæ•°çš„ä¸åŒï¼Œä¼šå¯¼è‡´`Array()`çš„è¡Œä¸ºæœ‰å·®å¼‚ã€‚
>    * `Array.of`åŸºæœ¬ä¸Šå¯ä»¥ç”¨æ¥æ›¿ä»£`Array()`æˆ–`new Array()`ï¼Œå¹¶ä¸”ä¸å­˜åœ¨ç”±äºå‚æ•°ä¸åŒè€Œå¯¼è‡´çš„é‡è½½ã€‚å®ƒçš„è¡Œä¸ºéå¸¸ç»Ÿä¸€ã€‚
>    * `Array.of`æ€»æ˜¯è¿”å›å‚æ•°å€¼ç»„æˆçš„æ•°ç»„ã€‚å¦‚æœæ²¡æœ‰å‚æ•°ï¼Œå°±è¿”å›ä¸€ä¸ªç©ºæ•°ç»„ã€‚
    
> * ã€ç‚¹å‡»æ‰“å¼€[demo](/effects/demo/es6/array/eg8.html)ã€‘    

```js
    // ä¾‹1ï¼šArray()
    console.log(Array()); // []
    console.log(Array(3)); // [, , ,]
    console.log(Array(3, 11, 8)); // [3, 11, 8]

    // ä¾‹2ï¼šArray.of()
    console.log(Array.of()); // []
    console.log(Array.of(3)); // [3]
    console.log(Array.of(3, 11, 8)); // [3, 11, 8]

```

---

> * Array.ofæ–¹æ³•å¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ¨¡æ‹Ÿå®ç°ã€‚

```js
function ArrayOf(){
  return [].slice.call(arguments);
}
```

## 4ã€æ•°ç»„å®ä¾‹çš„ copyWithin(target, start, end)

> * æ•°ç»„å®ä¾‹çš„ `copyWithin`æ–¹æ³•ï¼Œåœ¨å½“å‰æ•°ç»„å†…éƒ¨ï¼Œå°†æŒ‡å®šä½ç½®çš„æˆå‘˜å¤åˆ¶åˆ°å…¶ä»–ä½ç½®ï¼ˆ`ä¼šè¦†ç›–åŸæœ‰æˆå‘˜`ï¼‰ï¼Œç„¶åè¿”å›å½“å‰æ•°ç»„ã€‚å³ï¼š**ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¼šä¿®æ”¹å½“å‰æ•°ç»„**ã€‚
> * æ¥å—ä¸‰ä¸ªå‚æ•°
>    * `target`ï¼ˆå¿…éœ€ï¼‰ï¼šä»è¯¥ä½ç½®å¼€å§‹æ›¿æ¢æ•°æ®ã€‚
>    * `start`ï¼ˆå¯é€‰ï¼‰ï¼šä»è¯¥ä½ç½®å¼€å§‹è¯»å–æ•°æ®ï¼Œé»˜è®¤ä¸º0ã€‚å¦‚æœä¸ºè´Ÿå€¼ï¼Œè¡¨ç¤ºå€’æ•°ã€‚
>    * `end`ï¼ˆå¯é€‰ï¼‰ï¼šåˆ°è¯¥ä½ç½®å‰åœæ­¢è¯»å–æ•°æ®ï¼Œé»˜è®¤ç­‰äºæ•°ç»„é•¿åº¦ã€‚å¦‚æœä¸ºè´Ÿå€¼ï¼Œè¡¨ç¤ºå€’æ•°    

> * ã€ç‚¹å‡»æ‰“å¼€[demo](/effects/demo/es6/array/eg9.html)ã€‘  

```js
    // å°†3å·ä½å¤åˆ¶åˆ°0å·ä½
    console.log([1, 2, 3, 4, 5].copyWithin(0, 3, 4))  // [4, 2, 3, 4, 5]

    // -2ç›¸å½“äº3å·ä½ï¼Œ-1ç›¸å½“äº4å·ä½
    console.log([1, 2, 3, 4, 5].copyWithin(0, -2, -1))  // [4, 2, 3, 4, 5]

    // å°†3å·ä½å¤åˆ¶åˆ°0å·ä½
    console.log([].copyWithin.call({length: 5, 3: 1}, 0, 3))  // {0: 1, 3: 1, length: 5}

    // å°†2å·ä½åˆ°æ•°ç»„ç»“æŸï¼Œå¤åˆ¶åˆ°0å·ä½
    console.log( new Int32Array([1, 2, 3, 4, 5]).copyWithin(0, 2)); // Int32Array [3, 4, 5, 4, 5]

    // å¯¹äºæ²¡æœ‰éƒ¨ç½² TypedArray çš„ copyWithin æ–¹æ³•çš„å¹³å°
    // éœ€è¦é‡‡ç”¨ä¸‹é¢çš„å†™æ³•
    console.log([].copyWithin.call(new Int32Array([1, 2, 3, 4, 5]), 0, 3, 4));  // Int32Array [4, 2, 3, 4, 5]
```

## 5ã€æ•°ç»„å®ä¾‹çš„ find() å’Œ findIndex()

### 5.1 find()

> * `find()`æ–¹æ³•ï¼Œç”¨äºæ‰¾å‡ºç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„æ•°ç»„æˆå‘˜ã€‚
>    * å®ƒçš„å‚æ•°æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæ‰€æœ‰æ•°ç»„æˆå‘˜ä¾æ¬¡æ‰§è¡Œè¯¥å›è°ƒå‡½æ•°ï¼Œç›´åˆ°æ‰¾å‡º `ç¬¬ä¸€ä¸ª`è¿”å›å€¼ä¸º`true`çš„æˆå‘˜ï¼Œç„¶åè¿”å›è¯¥æˆå‘˜ã€‚å¦‚æœæ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„æˆå‘˜ï¼Œåˆ™è¿”å› `undefined`ã€‚
>        * findæ–¹æ³•çš„å›è°ƒå‡½æ•°å¯ä»¥æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œä¾æ¬¡ä¸º `å½“å‰çš„å€¼`ã€ `å½“å‰çš„ä½ç½®` å’Œ `åŸæ•°ç»„` ã€‚

> * ã€ç‚¹å‡»æ‰“å¼€[demo](/effects/demo/es6/array/eg10.html)ã€‘ 

```js
    let arr = [1, 5, 10, 14];
    const result = arr.find((value, index, arr) => {
      return value > 9;
    })
    console.log(result); // 10
```

### 5.2 findIndex()

> * ä¸ `find` æ–¹æ³•éå¸¸ç±»ä¼¼ï¼Œè¿”å›ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„æ•°ç»„æˆå‘˜çš„ä½ç½®ï¼Œå¦‚æœæ‰€æœ‰æˆå‘˜éƒ½ä¸ç¬¦åˆæ¡ä»¶ï¼Œåˆ™è¿”å›-1ã€‚
> * ã€ç‚¹å‡»æ‰“å¼€[demo](/effects/demo/es6/array/eg11.html)ã€‘ 

```js
    let arr = [1, 5, 10, 14];
    const result = arr.findIndex((value, index, arr) => {
      return value > 9;
    })
    console.log(result); // 2
```

### 5.3 ä¸¤è€…å…±åŒç‚¹

> 1. è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå‚æ•°ï¼Œç”¨æ¥ç»‘å®šå›è°ƒå‡½æ•°çš„thiså¯¹è±¡ã€‚
> 2. ä¸¤ä¸ªæ–¹æ³•éƒ½å¯ä»¥å‘ç°NaNï¼Œå¼¥è¡¥äº†æ•°ç»„çš„`IndexOf`æ–¹æ³•çš„ä¸è¶³ã€‚
>    * `indexOf`æ–¹æ³•æ— æ³•è¯†åˆ«æ•°ç»„çš„ `NaN` æˆå‘˜ï¼Œä½†æ˜¯`findIndex`æ–¹æ³•å¯ä»¥å€ŸåŠ©`Object.is` æ–¹æ³•åšåˆ°ã€‚

> * ã€ç‚¹å‡»æ‰“å¼€[demo](/effects/demo/es6/array/eg12.html)ã€‘ 

```js
    console.log([NaN].indexOf(NaN)); // -1

    console.log([NaN].findIndex(value => Object.is(NaN, value))); // 0
```

## 6ã€æ•°ç»„å®ä¾‹çš„fill()

> * `fill`æ–¹æ³•ä½¿ç”¨ç»™å®šå€¼ï¼Œå¡«å……ä¸€ä¸ªæ•°ç»„ã€‚
> * `fill`æ–¹æ³•ç”¨äºç©ºæ•°ç»„çš„åˆå§‹åŒ–éå¸¸æ–¹ä¾¿ã€‚æ•°ç»„ä¸­å·²æœ‰çš„å…ƒç´ ï¼Œä¼šè¢«å…¨éƒ¨æŠ¹å»ã€‚
> * `fill`æ–¹æ³•è¿˜å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œç”¨äºæŒ‡å®šå¡«å……çš„èµ·å§‹ä½ç½®å’Œç»“æŸä½ç½®ã€‚

> * ã€ç‚¹å‡»æ‰“å¼€[demo](/effects/demo/es6/array/eg13.html)ã€‘ 

```js
    let result1 = ['a', 'b', 'c'].fill(7);
    console.log(result1); // [7, 7, 7]

    let result2 = new Array(4).fill(3);
    console.log(result2); // [3, 3, 3, 3]

    // ä»1å·ä½å¼€å§‹ï¼Œå‘åŸæ•°ç»„å¡«å……7ï¼Œåˆ°2å·ä½ä¹‹å‰ç»“æŸ
    let result3 = ['a', 'b', 'c'].fill(7, 1, 2);
    console.log(result3); // ["a", 7, "c"]
```

## 8ã€ æ•°ç»„å®ä¾‹çš„ entries()ï¼Œkeys() å’Œ values()

> * `entries()`ï¼Œ`keys()`å’Œ`values()`â€”â€”ç”¨äºéå†æ•°ç»„ã€‚å®ƒä»¬éƒ½è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œå¯ä»¥ç”¨ `for...of` å¾ªç¯è¿›è¡Œéå†ï¼Œå”¯ä¸€çš„åŒºåˆ«ï¼š
>    * `keys()`æ˜¯å¯¹é”®åçš„éå†ã€‚
>    * `values()`æ˜¯å¯¹é”®å€¼çš„éå†ã€‚ã€å…¼å®¹æ€§é—®é¢˜ï¼Œæš‚æ—¶å¤§å¤šæ•°æµè§ˆå™¨ä¸æ”¯æŒï¼Œéƒ½ä¼šæŠ¥é”™ã€‘
>    * `entries()`æ˜¯å¯¹é”®å€¼å¯¹çš„éå†ã€‚

> * ã€ç‚¹å‡»æ‰“å¼€[demo](/effects/demo/es6/array/eg14.html)ã€‘ 

```js
    let arr = ['a', 'b', 'c'];

    // keys()
    for (let index of arr.keys()) {
      console.log(`index:${index}`);
      // index:0
      // index:1
      // index:2
    }

    // values() -- å¤§å¤šæ•°æµè§ˆå™¨æš‚æ—¶ä¸å…¼å®¹ - æŠ¥é”™
//    for (let ele of arr.values()) {
//      console.log(`value:${ele}`);
//    }

    for (let [index, ele] of arr.entries()) {
      console.log(`index:${index}, value:${ele}`)
      // index:0, value:a
      // index:1, value:d
      // index:2, value:c
    }

// å¦‚æœä¸ä½¿ç”¨for...ofå¾ªç¯ï¼Œå¯ä»¥æ‰‹åŠ¨è°ƒç”¨éå†å™¨å¯¹è±¡çš„nextæ–¹æ³•ï¼Œè¿›è¡Œéå†ã€‚
let entries = arr.entries();
console.log(entries.next().value); // [0, 'a']
console.log(entries.next().value); // [1, 'b']
console.log(entries.next().value); // [2, 'c']
```

## 8ã€ æ•°ç»„å®ä¾‹çš„ includes()

> * `Array.prototype.includes`æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæŸä¸ªæ•°ç»„æ˜¯å¦åŒ…å«ç»™å®šçš„å€¼ï¼Œ
> * ä¸ä¼šè¯¯åˆ¤ `NaN`ã€‚
> * è¯¥æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæœç´¢çš„èµ·å§‹ä½ç½®ï¼Œé»˜è®¤ä¸º`0`ã€‚
>    * å¦‚æœç¬¬äºŒä¸ªå‚æ•°ä¸ºè´Ÿæ•°ï¼Œåˆ™è¡¨ç¤ºå€’æ•°çš„ä½ç½®ã€‚
>    * å¦‚æœè¿™æ—¶å®ƒå¤§äºæ•°ç»„é•¿åº¦ï¼ˆæ¯”å¦‚ç¬¬äºŒä¸ªå‚æ•°ä¸º-4ï¼Œä½†æ•°ç»„é•¿åº¦ä¸º3ï¼‰ï¼Œåˆ™ä¼šé‡ç½®ä¸ºä»0å¼€å§‹ã€‚

> * æ²¡æœ‰è¯¥æ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨æ•°ç»„çš„ `indexOf` æ–¹æ³•ï¼Œæ£€æŸ¥æ˜¯å¦åŒ…å«æŸä¸ªå€¼ã€‚
>    * `indexOf` æ–¹æ³•æœ‰ä¸¤ä¸ªç¼ºç‚¹ï¼š
>        1. ä¸å¤Ÿè¯­ä¹‰åŒ–ï¼Œå®ƒçš„å«ä¹‰æ˜¯æ‰¾åˆ°å‚æ•°å€¼çš„ç¬¬ä¸€ä¸ªå‡ºç°ä½ç½®ï¼Œæ‰€ä»¥è¦å»æ¯”è¾ƒæ˜¯å¦ä¸ç­‰äº-1ï¼Œè¡¨è¾¾èµ·æ¥ä¸å¤Ÿç›´è§‚ã€‚
>        2. å®ƒå†…éƒ¨ä½¿ç”¨ä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦ï¼ˆ`===`ï¼‰è¿›è¡Œåˆ¤æ–­ï¼Œè¿™ä¼šå¯¼è‡´å¯¹ `NaN` çš„è¯¯åˆ¤ã€‚

> * ã€ç‚¹å‡»æ‰“å¼€[demo](/effects/demo/es6/array/eg15.html)ã€‘ 
        
```js
    let arr = ['a', 2, 'c', NaN];

    console.log(arr.includes(2)); // true
    console.log(arr.includes(NaN)); // true
    
    console.log(arr.indexOf(NaN)); // -1
```

> * ä¸‹é¢ä»£ç ç”¨æ¥æ£€æŸ¥å½“å‰ç¯å¢ƒæ˜¯å¦æ”¯æŒè¯¥æ–¹æ³•ï¼Œå¦‚æœä¸æ”¯æŒï¼Œéƒ¨ç½²ä¸€ä¸ªç®€æ˜“çš„æ›¿ä»£ç‰ˆæœ¬ã€‚

```js
const contains = (() =>
  Array.prototype.includes
    ? (arr, value) => arr.includes(value)
    : (arr, value) => arr.some(el => el === value)
)();
contains(['foo', 'bar'], 'baz'); // => false
```

> * å¦å¤–ï¼Œ`Map` å’Œ `Set` æ•°æ®ç»“æ„æœ‰ä¸€ä¸ª `has` æ–¹æ³•ï¼Œéœ€è¦æ³¨æ„ä¸ `includes`åŒºåˆ†ã€‚
>    * `Map` ç»“æ„çš„ `has` æ–¹æ³•ï¼Œæ˜¯ç”¨æ¥æŸ¥æ‰¾é”®åçš„ï¼Œæ¯”å¦‚ `Map.prototype.has(key)`ã€`WeakMap.prototype.has(key)`ã€`Reflect.has(target, propertyKey)`ã€‚
>    * `Set` ç»“æ„çš„ `has`æ–¹æ³•ï¼Œæ˜¯ç”¨æ¥æŸ¥æ‰¾å€¼çš„ï¼Œæ¯”å¦‚ `Set.prototype.has(value)`ã€`WeakSet.prototype.has(value)`ã€‚

## 9ã€æ•°ç»„çš„ç©ºä½

### 9.1 æ•°ç»„çš„ç©ºä½æ˜¯ä»€ä¹ˆ

> * æ•°ç»„çš„ç©ºä½æŒ‡ï¼Œæ•°ç»„çš„æŸä¸€ä¸ªä½ç½®æ²¡æœ‰ä»»ä½•å€¼ã€‚
>   * ç©ºä½ä¸æ˜¯ `undefined`ï¼Œä¸€ä¸ªä½ç½®çš„å€¼ç­‰äº`undefined`ï¼Œä¾ç„¶æ˜¯æœ‰å€¼çš„ã€‚
>   * ç©ºä½æ˜¯æ²¡æœ‰ä»»ä½•å€¼ï¼Œ`in`è¿ç®—ç¬¦å¯ä»¥è¯´æ˜è¿™ä¸€ç‚¹ã€‚

> * ã€ç‚¹å‡»æ‰“å¼€[demo](/effects/demo/es6/array/eg16.html)ã€‘ 

```js
Array(3) // [, , ,]ï¼Œã€‚

0 in [undefined, undefined, undefined] // true
0 in [, , ,] // false
```

### 9.2 ES5 å¯¹ç©ºä½çš„å¤„ç†

> * å¤§å¤šæ•°æƒ…å†µä¸‹ä¼šå¿½ç•¥ç©ºä½ã€‚
>    * `forEach()`, `filter()`, `every()` å’Œ`some()`éƒ½ä¼šè·³è¿‡ç©ºä½ã€‚
>    * `map()`ä¼šè·³è¿‡ç©ºä½ï¼Œä½†ä¼šä¿ç•™è¿™ä¸ªå€¼
>    * `join()`å’Œ`toString()`ä¼šå°†ç©ºä½è§†ä¸º`undefined`ï¼Œè€Œ`undefined`å’Œ`null`ä¼šè¢«å¤„ç†æˆç©ºå­—ç¬¦ä¸²ã€‚

> * ã€ç‚¹å‡»æ‰“å¼€[demo](/effects/demo/es6/array/eg17.html)ã€‘ 

```js
    // forEach
    [, 'a'].forEach((v, i) => {
      console.log(v, i);
      // a 1
    })

    // filter
    const result1 = ['b', , 'a'].filter((v, i) => {
       return true;
    });
    console.log(result1); //  ["b", "a"]

    // every
    const result2 = [, 'a'].every((x) => {
      return x === 'a';
    })
    console.log(result2); // true

    // some
    const result3 = [, 'a'].some((x) => {
      return x !== 'a';
    })
    console.log(result3); // false

    // map
    const result4 = [, 'a'].map((x) => {
      return 1;
    })
    console.log(result4); // [, 1]

    // join
    console.log([, 'a', undefined, null].join('#')); // #a##

    // toString()
    console.log([, 'a', undefined, null].toString()); // ,a,,
```

### 9.3 ES6 å¯¹ç©ºä½çš„å¤„ç†

> * ES6 åˆ™æ˜¯æ˜ç¡®å°†ç©ºä½è½¬ä¸º `undefined`ã€‚
>    1. `Array.from`æ–¹æ³•ä¼šå°†æ•°ç»„çš„ç©ºä½ï¼Œè½¬ä¸º`undefined`ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªæ–¹æ³•ä¸ä¼šå¿½ç•¥ç©ºä½ã€‚
>    2. æ‰©å±•è¿ç®—ç¬¦ï¼ˆ...ï¼‰ä¹Ÿä¼šå°†ç©ºä½è½¬ä¸º`undefined`ã€‚
>    3. `copyWithin()`ä¼šè¿ç©ºä½ä¸€èµ·æ‹·è´ã€‚
>    4. `fill()`ä¼šå°†ç©ºä½è§†ä¸ºæ­£å¸¸çš„æ•°ç»„ä½ç½®ã€‚
>    5. `for...of`å¾ªç¯ä¹Ÿä¼šéå†ç©ºä½ã€‚
>    6. `entries()`ã€`keys()`ã€`values()`ã€`find()`å’Œ`findIndex()`ä¼šå°†ç©ºä½å¤„ç†æˆ `undefined`ã€‚

> * ã€ç‚¹å‡»æ‰“å¼€[demo](/effects/demo/es6/array/eg18.html)ã€‘ 

```js
    // Array.from
    console.log(Array.from([1, , 3])); // [1, undefined, 3]

    // ...æ‰©å±•ç¬¦
    console.log(...[1, , 3]); // [1, undefined, 3]

    // copyWithin
    console.log([, 2, , 4].copyWithin(2, 0)); // [, 2, , 2]

    // for ... of
    for (let i of [, ,]) {
      console.log(i);
      // undefined
      // undefined
    }
```
